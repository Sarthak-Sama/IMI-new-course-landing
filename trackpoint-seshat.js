(()=>{const t=(()=>{const t="https://trackpoint.emeritus-analytics.io/track",e=document.head,n=window.navigator.userAgent,a=e.getAttribute("data-merge-with-paegmeta"),r=(n={})=>{const r=i(),s=(()=>{let t={};const n=e.getAttribute("data-tracking-events"),a=e.getAttribute("data-landing-page-template-id"),r=e.getAttribute("data-active-experiments"),i=e.getAttribute("data-trackpoint-meta");let s={};if(i)return t=JSON.parse(i),t;if(n){const e=JSON.parse(n)[0];if(e){const n=e.properties,{school_name:a,screen_name:r,program:i}=n;i&&(s.program_name=i.name,s.lpid=i.sfid),s.school_name=a,t.screen_name=r}}return s.lpid=a,t.program=s,r&&(t.active_experiments=JSON.parse(r).active_experiment),t})()||{},o="Y"===a?{...s,...n}:{...n,...s};r.event_properties=JSON.stringify(o),o.type;const c="bot"===o.interaction,u="staging"===o.env||"staging"===o.environment||"review_app"===o.environment?"https://seshat-node-api-staging-24b594fbd85f.herokuapp.com/seshat/track":"https://seshat-api.emeritus.org/seshat/track",d=new Blob([JSON.stringify(r)],{"Content-Type":"application/json"}),p=new Blob([JSON.stringify(r)],{type:"application/json"}),g=!c&&r.user_uuid,l=!(!o.environment&&!o.env);try{if(!navigator.sendBeacon)throw new Error("navigator.sendBeacon is not supported");g&&navigator.sendBeacon(t,d),l&&navigator.sendBeacon(u,p)}catch(e){if(console.info("navigator.sendBeacon failed, falling back to XMLHttpRequest:"),g){const e=new XMLHttpRequest;e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/json"),e.send(d)}if(l){const t=new XMLHttpRequest;t.open("POST",u,!0),t.setRequestHeader("Content-Type","application/json"),t.send(p)}}},i=()=>{const{requestUUID:t,userUUID:e}=s(),a=new URL(window.document.URL);return{request_uuid:t,user_uuid:e,request_ts:(new Date).toISOString(),user_agent:n,query_string:a.search,referer:window.document.referrer,path:a.pathname,host:a.host}},s=()=>{let t=null,n=null;const a=e.getAttribute("data-request-ids");if(a){const e=JSON.parse(a);t=e.request_uuid,n=e.user_uuid}else t=e.getAttribute("data-requestuuid"),n=e.getAttribute("data-useruuid");return{requestUUID:t,userUUID:n}},o={},c=t=>{const e=t.target.closest('[data-track]:not([data-track=""]');if(e)return r(JSON.parse(e.getAttribute("data-track"))),!0};return o.attachEvents=function(){document.body.addEventListener("click",(t=>{let e=null,n=null;const a=t.target,i=a.tagName;"INPUT"!==a.nodeName&&c(t)||(["LABEL","A","U","I","EM"].includes(i)&&(n=t.target.getAttribute("title")||t.target.innerText),n&&(n=n.trim(),e={type:"click",event:n.replace(/ /g,"_")}),e&&r(e))})),document.body.addEventListener("focus",(t=>{"INPUT"===t.target.tagName&&c(t)}),!0)},o.trigger=t=>{r(t)},o.attachConsentEvent=function(){window.addEventListener("UC_UI_CMP_EVENT",(t=>{const e=t?.detail;if(e&&e?.type){const t=e?.abTestVariant,n=JSON.parse(sessionStorage.getItem("uc_user_country")||"{}");r({type:e.type,active_experiments:`ab_UC:${t}`,uc_consent_id:window?.UC_UI?.getControllerId?.()||"",uc_user_country:n?.countryCode}),t&&(o.ucVariant={ab_UC:t})}}))},o.init=()=>{o.attachEvents(),o.attachConsentEvent(),r({type:"page_view"})},o})();window.trackPoint=window.trackPoint||t,t.init()})();